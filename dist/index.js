!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).jsTrackingReport=n()}(this,(function(){"use strict";const e=e=>{const n=navigator.userAgent,t={Windows:function(){var e=n.replace(/^.*Windows NT ([\d.]+);.*$/,"$1");return{6.4:"10",6.3:"8.1",6.2:"8",6.1:"7","6.0":"Vista",5.2:"XP",5.1:"XP","5.0":"2000"}[e]||e},Android:function(){return n.replace(/^.*Android ([\d.]+);.*$/,"$1")},iOS:function(){return n.replace(/^.*OS ([\d_]+) like.*$/,"$1").replace(/_/g,".")},Debian:function(){return n.replace(/^.*Debian\/([\d.]+).*$/,"$1")},"Windows Phone":function(){return n.replace(/^.*Windows Phone( OS)? ([\d.]+);.*$/,"$2")},"Mac OS":function(){return n.replace(/^.*Mac OS X ([\d_]+).*$/,"$1").replace(/_/g,".")},WebOS:function(){return n.replace(/^.*hpwOS\/([\d.]+);.*$/,"$1")}};let i="";return t[e]&&(i=t[e](),i==n&&(i="")),i};var n=()=>{const n=(()=>{const e={Trident:(n=navigator.userAgent).indexOf("Trident")>-1||n.indexOf("NET CLR")>-1,Presto:n.indexOf("Presto")>-1,WebKit:n.indexOf("AppleWebKit")>-1,Gecko:n.indexOf("Gecko/")>-1,Safari:n.indexOf("Safari")>-1,Chrome:n.indexOf("Chrome")>-1||n.indexOf("CriOS")>-1,IE:n.indexOf("MSIE")>-1||n.indexOf("Trident")>-1,Edge:n.indexOf("Edge")>-1,Firefox:n.indexOf("Firefox")>-1||n.indexOf("FxiOS")>-1,"Firefox Focus":n.indexOf("Focus")>-1,Chromium:n.indexOf("Chromium")>-1,Opera:n.indexOf("Opera")>-1||n.indexOf("OPR")>-1,Vivaldi:n.indexOf("Vivaldi")>-1,Yandex:n.indexOf("YaBrowser")>-1,Arora:n.indexOf("Arora")>-1,Lunascape:n.indexOf("Lunascape")>-1,QupZilla:n.indexOf("QupZilla")>-1,"Coc Coc":n.indexOf("coc_coc_browser")>-1,Kindle:n.indexOf("Kindle")>-1||n.indexOf("Silk/")>-1,Iceweasel:n.indexOf("Iceweasel")>-1,Konqueror:n.indexOf("Konqueror")>-1,Iceape:n.indexOf("Iceape")>-1,SeaMonkey:n.indexOf("SeaMonkey")>-1,Epiphany:n.indexOf("Epiphany")>-1,360:n.indexOf("QihooBrowser")>-1||n.indexOf("QHBrowser")>-1,"360EE":n.indexOf("360EE")>-1,"360SE":n.indexOf("360SE")>-1,UC:n.indexOf("UC")>-1||n.indexOf(" UBrowser")>-1,QQBrowser:n.indexOf("QQBrowser")>-1,QQ:n.indexOf("QQ/")>-1,Baidu:n.indexOf("Baidu")>-1||n.indexOf("BIDUBrowser")>-1,Maxthon:n.indexOf("Maxthon")>-1,Sogou:n.indexOf("MetaSr")>-1||n.indexOf("Sogou")>-1,LBBROWSER:n.indexOf("LBBROWSER")>-1,"2345Explorer":n.indexOf("2345Explorer")>-1,TheWorld:n.indexOf("TheWorld")>-1,XiaoMi:n.indexOf("MiuiBrowser")>-1,Quark:n.indexOf("Quark")>-1,Qiyu:n.indexOf("Qiyu")>-1,Wechat:n.indexOf("MicroMessenger")>-1,WechatWork:n.indexOf("wxwork/")>-1,Taobao:n.indexOf("AliApp(TB")>-1,Alipay:n.indexOf("AliApp(AP")>-1,Weibo:n.indexOf("Weibo")>-1,Douban:n.indexOf("com.douban.frodo")>-1,Suning:n.indexOf("SNEBUY-APP")>-1,iQiYi:n.indexOf("IqiyiApp")>-1,Windows:n.indexOf("Windows")>-1,Linux:n.indexOf("Linux")>-1||n.indexOf("X11")>-1,"Mac OS":n.indexOf("Macintosh")>-1,Android:n.indexOf("Android")>-1||n.indexOf("Adr")>-1,Ubuntu:n.indexOf("Ubuntu")>-1,FreeBSD:n.indexOf("FreeBSD")>-1,Debian:n.indexOf("Debian")>-1,"Windows Phone":n.indexOf("IEMobile")>-1||n.indexOf("Windows Phone")>-1,BlackBerry:n.indexOf("BlackBerry")>-1||n.indexOf("RIM")>-1,MeeGo:n.indexOf("MeeGo")>-1,Symbian:n.indexOf("Symbian")>-1,iOS:n.indexOf("like Mac OS X")>-1,"Chrome OS":n.indexOf("CrOS")>-1,WebOS:n.indexOf("hpwOS")>-1,Mobile:n.indexOf("Mobi")>-1||n.indexOf("iPh")>-1||n.indexOf("480")>-1,Tablet:n.indexOf("Tablet")>-1||n.indexOf("Nexus 7")>-1,iPad:n.indexOf("iPad")>-1};var n;const t={engine:["WebKit","Trident","Gecko","Presto"],browser:["Safari","Chrome","Edge","IE","Firefox","Firefox Focus","Chromium","Opera","Vivaldi","Yandex","Arora","Lunascape","QupZilla","Coc Coc","Kindle","Iceweasel","Konqueror","Iceape","SeaMonkey","Epiphany","360","360SE","360EE","UC","QQBrowser","QQ","Baidu","Maxthon","Sogou","LBBROWSER","2345Explorer","TheWorld","XiaoMi","Quark","Qiyu","Wechat",,"WechatWork","Taobao","Alipay","Weibo","Douban","Suning","iQiYi"],os:["Windows","Linux","Mac OS","Android","Ubuntu","FreeBSD","Debian","iOS","Windows Phone","BlackBerry","MeeGo","Symbian","Chrome OS","WebOS"],device:["Mobile","Tablet","iPad"]},i={};for(let n in t)for(let a=0;a<t[n].length;a++){const r=t[n][a];e[r]&&(i[n]=r)}const a=navigator.userAgent.toLowerCase(),r=e=>{const n=e();return e=>n?e(n):""},o={IE:()=>r((()=>a.match(/(msie\s|trident.*rv:)([\w.]+)/)))((e=>e[2])),Chrome:()=>r((()=>a.match(/chrome\/([\d.]+)/)))((e=>e[1])),Firefox:()=>r((()=>a.match(/firefox\/([\d.]+)/)))((e=>e[1])),Opera:()=>r((()=>a.match(/opera\/([\d.]+)/)))((e=>e[1])),Safari:()=>r((()=>a.match(/version\/([\d.]+)/)))((e=>e[1])),Edge:()=>r((()=>a.match(/edge\/([\d.]+)/)))((e=>e[1])),QQBrowser:()=>r((()=>a.match(/qqbrowser\/([\d.]+)/)))((e=>e[1]))};return i.version=o[i.browser]?o[i.browser]():"",i})();return{...n,osVersion:e(n.os)}};return e=>{e={dataName:{pageLoad:"data-tracking-page-load",elementClick:"data-tracking-element-click",elementView:"data-tracking-element-view"},processData:e=>({...e.attrData}),submitData:()=>Promise.resolve(),submitConditions:()=>!0,elementViewConditions:()=>!0,...e};const t=Date.now(),i=(e,n)=>e.hasAttribute(n)?e:"body"===e.nodeName.toLowerCase()?null:i(e.parentElement,n),a=()=>{const e=0===location.hash.indexOf("#/");let n=location.pathname;return e&&(n=location.hash.slice(1)),"/"!==n&&"/"===n.slice(-1)&&(n=n.slice(0,-1)),n},r=e=>Array.from(e.parentElement.children).indexOf(e),o=e=>{const n=e.getBoundingClientRect().height,t=e.getBoundingClientRect().y,i=window.innerHeight;return i-t>0&&i-t-n<=i},d=async(n,t)=>{let i=n.getAttribute(t);return"async"===i&&(i=await new Promise((i=>{if("undefined"==typeof MutationObserver){let e=0;const a=setInterval((()=>{const r=n.getAttribute(t);if(e+=1,"async"!==r)return i(r),void clearInterval(a);e>=5&&(i("{}"),clearInterval(a))}),1e3)}else{const a=new MutationObserver((r=>{for(let o of r)"attributes"===o.type&&Object.values(e.dataName).includes(o.attributeName)&&(a.disconnect(),i(n.getAttribute(t)))}));a.observe(n,{attributes:!0})}}))),JSON.parse(i||"{}")},s=()=>JSON.parse(localStorage.getItem("data-tracking"))||[],c=()=>{localStorage.removeItem("data-tracking")},f=e=>{const n=s();return n.push(e),(e=>{localStorage.setItem("data-tracking",JSON.stringify(e))})(n),n},l=()=>{const n=s();n.length&&e.submitData(n).then((e=>{!1!==e&&c()}))},u=async(i,r,o={})=>{const d=await e.processData({page:{url:location.href,host:location.host,hostName:location.hostname,pathName:a(),title:document.title,referrer:document.referrer,referrerHost:document.referrer.split("/")[2]||""},cookie:(()=>{if(!document.cookie)return{};const e=document.cookie.split(";"),n={};for(let t of e){const[e,i]=t.split("=");n[e.trim()]=i.trim()}return n})(),navigator:{language:(()=>{const e=(navigator.browserLanguage||navigator.language).split("-");return e[1]&&(e[1]=e[1].toUpperCase()),e.join("-")})(),userAgent:navigator.userAgent,platform:navigator.platform,appName:navigator.appName,viewportWidth:window.innerWidth,viewportHeight:window.innerHeight,screenWidth:window.screen.width,screenHeight:window.screen.height,...n()},attrData:i},{eventType:r,firstDateTime:t,eventDateTime:Date.now(),pathName:a(),...o});return f(d)},O=async(n,t,i={})=>{const a=await u(n,t,i);e.submitConditions(a)&&l()},x=async()=>{const n=document.querySelector(`[${e.dataName.pageLoad}]`);if(!n)return;const t=await d(n,e.dataName.pageLoad);n.hasAttribute(e.dataName.pageLoad)&&(n.removeAttribute(e.dataName.pageLoad),O(t,"pageLoad",{element:n,dataIndex:0}))};return(()=>{let n=()=>{};const t=()=>{x(),document.addEventListener("click",(async n=>{const t=i(n.target,e.dataName.elementClick);if(!t)return;const a=await d(t,e.dataName.elementClick);O(a,"elementClick",{element:t,dataIndex:r(t)})})),n=(()=>{let n=[],t=null;const i=(t=!0)=>{const i=Array.from(document.querySelectorAll(`[${e.dataName.elementView}]`));if(0!==i.length)for(let a of i){if(!o(a))continue;if(n.find((e=>e===a)))continue;const i=n.push(a)-1,s=async()=>{if(n.splice(i,1),a.hasAttribute(e.dataName.elementView)&&o(a)&&e.elementViewConditions(a)){const n=await d(a,e.dataName.elementView);if(!a.hasAttribute(e.dataName.elementView))return;a.removeAttribute(e.dataName.elementView),O(n,"elementView",{element:a,dataIndex:r(a)})}};t?setTimeout(s,1200):s()}};return window.addEventListener("touchend",(()=>{setTimeout(i,100)})),window.addEventListener("wheel",(()=>{clearTimeout(t),t=setTimeout((()=>{i()}),60)})),i})(),n(!1),setInterval((()=>{x(),n(!1)}),1200)};"complete"!==document.readyState?window.addEventListener("load",t):t()})(),{submitData:l,getDataList:s,pushData:u,emptyData:c}}}));